# ESPHome-Thermostate-Moes-BHT-002


Большое распространение у любителей домашней автоматизации получили WIFI dthcbb термостатов Moes-BHT-002.

![1](https://user-images.githubusercontent.com/11642286/208393574-359c222d-f9fa-4e75-8af6-3d01674839ef.jpg)

Полное название  BHT-002-GBLW. Это вай-фай термостат электрического теплого пола из экосистемы Tuya.
Конечно его можно использовать в родной экосистеме. Можно подключить к другим системам с использованием различных
плгагинов и стыков. 
Я использую Home Assistant и для подключения у меня были варианты:
- Интеграция Tuya https://www.home-assistant.io/integrations/tuya/
- Интеграция Local Tuya https://github.com/rospogrigio/localtuya
- Перешить используя проект https://github.com/klausahrenberg/WThermostatBeca и подключить через MQTT

Все эти способы рабочие, но имеют недостатки. Где то обязательно нужно наличие подключения к внешним серверам,
где то вы не сможете использовать весь потенциал устройства, где то будут ошибки и непонятки. Да и ни один из
этих способов не будет 100% под вашим контролем. Поизучав последний проект я пришел к выводу, что было бы не 
плохо написать компонент для ESPHome. Тем более, что за связь в этом устройстве отвечает модуль Tuwe3S, который
оказался аналогом ESP-12. Термостат имеет процессор который обслуживает процесс нагрева и управления и по UART
обменивается данными с модулем Tuwe3S. Естественно найти полное описание протокола не удалось, в проекте
WThermostatBeca был описан лишь служебный обмен, остального нет. Пришлось расшифровывать протокол, помогло то,
что он простой и выполнен в китайском стиле :)) 

На выходе получается прошивка, которая является родной для ESPHome. Как всегда основная проблема первоначально 
залить ее в Tuwe3S. Знаю, что есть проект, который позволяет ничего не паяя заменить прошивку в устройствах от
Туя. Мне проше припаяться. Схема стандартная:

